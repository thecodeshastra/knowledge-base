"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[8494],{4679(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"virtual_env/tox_env","title":"Tox","description":"tox is a testing automation tool","source":"@site/../docs/virtual_env/tox_env.md","sourceDirName":"virtual_env","slug":"/virtual_env/tox_env","permalink":"/knowledge-base/docs/virtual_env/tox_env","draft":false,"unlisted":false,"editUrl":"https://github.com/thecodeshastra/knowledge-base/tree/main/site/../docs/virtual_env/tox_env.md","tags":[],"version":"current","frontMatter":{"title":"Tox"},"sidebar":"docsSidebar","previous":{"title":"Python Virtual Env","permalink":"/knowledge-base/docs/virtual_env/python_virtual_env"},"next":{"title":"Uv","permalink":"/knowledge-base/docs/virtual_env/uv"}}');var l=s(4848),i=s(8453);const r={title:"Tox"},o="Tox",c={},a=[{value:"Why use tox?",id:"why-use-tox",level:2},{value:"When to use tox vs venv/uv",id:"when-to-use-tox-vs-venvuv",level:2},{value:"Install tox",id:"install-tox",level:2},{value:"Global (recommended)",id:"global-recommended",level:3},{value:"Check installation",id:"check-installation",level:3},{value:"1\ufe0f\u20e3 Configure tox: Create tox.ini",id:"1\ufe0f\u20e3-configure-tox-create-toxini",level:2},{value:"2\ufe0f\u20e3 Modern: Use tox.toml instead",id:"2\ufe0f\u20e3-modern-use-toxtoml-instead",level:2},{value:"3\ufe0f\u20e3 Run all tests",id:"3\ufe0f\u20e3-run-all-tests",level:2},{value:"4\ufe0f\u20e3 Run specific environment",id:"4\ufe0f\u20e3-run-specific-environment",level:2},{value:"5\ufe0f\u20e3 Skip certain environments",id:"5\ufe0f\u20e3-skip-certain-environments",level:2},{value:"6\ufe0f\u20e3 Rebuild environments",id:"6\ufe0f\u20e3-rebuild-environments",level:2},{value:"7\ufe0f\u20e3 Pass arguments to tests",id:"7\ufe0f\u20e3-pass-arguments-to-tests",level:2},{value:"8\ufe0f\u20e3 List all environments",id:"8\ufe0f\u20e3-list-all-environments",level:2},{value:"9\ufe0f\u20e3 Parallel execution",id:"9\ufe0f\u20e3-parallel-execution",level:2},{value:"\ud83d\udd01 One Real Project Example",id:"-one-real-project-example",level:2},{value:"Step 1: Create tox.ini",id:"step-1-create-toxini",level:3},{value:"Step 2: Install tox",id:"step-2-install-tox",level:3},{value:"Step 3: Run all environments",id:"step-3-run-all-environments",level:3},{value:"Step 4: Use in CI/CD (GitHub Actions)",id:"step-4-use-in-cicd-github-actions",level:3},{value:"\ud83e\udde0 Daily workflow to remember",id:"-daily-workflow-to-remember",level:2},{value:"\ud83e\udde0 Memory trick",id:"-memory-trick",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"tox",children:"Tox"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"tox"})," is a ",(0,l.jsx)(n.strong,{children:"testing automation tool"})]}),"\n",(0,l.jsxs)(n.p,{children:["It runs your tests against ",(0,l.jsx)(n.strong,{children:"multiple Python versions"})," simultaneously + automates linting, type-checking, and other workflows."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"why-use-tox",children:"Why use tox?"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\ud83d\udd04 Test against Python 3.9, 3.10, 3.11, 3.12 at once"}),"\n",(0,l.jsx)(n.li,{children:"\ud83e\uddf9 Automate: tests + lint + type-check + docs"}),"\n",(0,l.jsx)(n.li,{children:"\ud83d\udce6 Libraries must support multiple Python versions (tox proves it)"}),"\n",(0,l.jsxs)(n.li,{children:["\ud83c\udfd7\ufe0f Creates ",(0,l.jsx)(n.strong,{children:"isolated test environments"})," (like venv but automated)"]}),"\n",(0,l.jsx)(n.li,{children:"\ud83d\ude80 CI/CD friendly (GitHub Actions, GitLab CI, etc. use tox)"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Tl;dr:"})," If you're building a library/package \u2192 tox is non-negotiable."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"when-to-use-tox-vs-venvuv",children:"When to use tox vs venv/uv"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Use case"}),(0,l.jsx)(n.th,{children:"Tool"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Single project development"}),(0,l.jsx)(n.td,{children:"venv / uv"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Testing multiple Python versions"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"tox"})," \u2713"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Library/package (must support v3.9-3.12)"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"tox"})," \u2713"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Testing + linting + type-checking pipeline"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.strong,{children:"tox"})," \u2713"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Web app deployment (one Python version)"}),(0,l.jsx)(n.td,{children:"venv / uv"})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"install-tox",children:"Install tox"}),"\n",(0,l.jsx)(n.h3,{id:"global-recommended",children:"Global (recommended)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pip install tox\n"})}),"\n",(0,l.jsx)(n.p,{children:"Or with uv:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"uv tool install tox\n"})}),"\n",(0,l.jsx)(n.h3,{id:"check-installation",children:"Check installation"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox --version\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"1\ufe0f\u20e3-configure-tox-create-toxini",children:"1\ufe0f\u20e3 Configure tox: Create tox.ini"}),"\n",(0,l.jsxs)(n.p,{children:["In your project root, create ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"tox.ini"})}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ini",children:"[tox]\nenvlist = py39,py310,py311,py312,lint,type,docs\n\n[testenv]\ndeps = \n    pytest\n    pytest-cov\n    requests\ncommands = \n    pytest {posargs}\n    pytest --cov=myapp\n\n[testenv:lint]\ndeps = \n    flake8\n    black\n    isort\ncommands =\n    black --check .\n    isort --check-only .\n    flake8 .\n\n[testenv:type]\ndeps = \n    mypy\n    types-requests\ncommands =\n    mypy myapp\n\n[testenv:docs]\ndeps = \n    sphinx\n    sphinx-rtd-theme\ncommands =\n    sphinx-build -b html docs docs/_build\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"What this does:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"envlist"}),": Test on py39, py310, py311, py312, plus lint/type/docs environments"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"[testenv]"}),": Base test environment (runs pytest)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"[testenv:lint]"}),": Linting environment (runs flake8, black, isort)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"[testenv:type]"}),": Type-checking environment (runs mypy)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"[testenv:docs]"}),": Documentation environment (runs sphinx)"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"2\ufe0f\u20e3-modern-use-toxtoml-instead",children:"2\ufe0f\u20e3 Modern: Use tox.toml instead"}),"\n",(0,l.jsxs)(n.p,{children:["If your project uses ",(0,l.jsx)(n.code,{children:"pyproject.toml"}),", you can use ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"tox.toml"})})," (modern approach):"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[tool.tox]\nlegacy_tox_ini = "tox.ini"\n\n[build-system]\nrequires = ["setuptools>=45", "wheel"]\nbuild-backend = "setuptools.build_meta"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Or full tox config in ",(0,l.jsx)(n.code,{children:"pyproject.toml"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[tool.tox]\nenvlist = ["py39", "py310", "py311", "py312", "lint", "type"]\n\n[tool.tox.testenv]\ndeps = ["pytest", "pytest-cov"]\ncommands = ["pytest"]\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Note:"})," ",(0,l.jsx)(n.code,{children:"tox.ini"})," is more common (works everywhere). ",(0,l.jsx)(n.code,{children:"tox.toml"})," is newer and cleaner."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"3\ufe0f\u20e3-run-all-tests",children:"3\ufe0f\u20e3 Run all tests"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox\n"})}),"\n",(0,l.jsx)(n.p,{children:"This runs:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Tests on py39, py310, py311, py312"}),"\n",(0,l.jsx)(n.li,{children:"Lint environment"}),"\n",(0,l.jsx)(n.li,{children:"Type-checking environment"}),"\n",(0,l.jsx)(n.li,{children:"Docs environment"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Output shows which environments ",(0,l.jsx)(n.strong,{children:"PASSED"})," or ",(0,l.jsx)(n.strong,{children:"FAILED"}),"."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"4\ufe0f\u20e3-run-specific-environment",children:"4\ufe0f\u20e3 Run specific environment"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py311\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run only Python 3.11 tests."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e lint\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run only linting environment."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py310,py311\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run Python 3.10 and 3.11."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"5\ufe0f\u20e3-skip-certain-environments",children:"5\ufe0f\u20e3 Skip certain environments"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py39,py310,py311,py312 --skip-missing-interpreters\n"})}),"\n",(0,l.jsx)(n.p,{children:"Skip if Python version not installed (don't fail)."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py39,py310 -x\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Stop on first failure (",(0,l.jsx)(n.code,{children:"-x"})," flag)."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"6\ufe0f\u20e3-rebuild-environments",children:"6\ufe0f\u20e3 Rebuild environments"}),"\n",(0,l.jsxs)(n.p,{children:["By default, tox ",(0,l.jsx)(n.strong,{children:"caches environments"}),". Rebuild if dependencies changed:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -r\n"})}),"\n",(0,l.jsx)(n.p,{children:"Or recreate specific environment:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py311 -r\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"7\ufe0f\u20e3-pass-arguments-to-tests",children:"7\ufe0f\u20e3 Pass arguments to tests"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -e py311 -- -v\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Pass ",(0,l.jsx)(n.code,{children:"-v"})," (verbose) to pytest."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -- tests/test_auth.py::test_login\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run specific test file."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"8\ufe0f\u20e3-list-all-environments",children:"8\ufe0f\u20e3 List all environments"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -l\n"})}),"\n",(0,l.jsx)(n.p,{children:"Shows:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"py39\npy310\npy311\npy312\nlint\ntype\ndocs\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"9\ufe0f\u20e3-parallel-execution",children:"9\ufe0f\u20e3 Parallel execution"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -p\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run environments in parallel (faster)."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox -p 4\n"})}),"\n",(0,l.jsx)(n.p,{children:"Run 4 environments at once."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-one-real-project-example",children:"\ud83d\udd01 One Real Project Example"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Scenario:"})," Building a Python library that needs to support Python 3.9\u20133.12."]}),"\n",(0,l.jsx)(n.h3,{id:"step-1-create-toxini",children:"Step 1: Create tox.ini"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat > tox.ini << 'EOF'\n[tox]\nenvlist = py39,py310,py311,py312,lint\n\n[testenv]\ndeps = \n    pytest\n    pytest-cov\n    requests\ncommands = \n    pytest tests/\n    pytest --cov=mylib --cov-report=term-missing\n\n[testenv:lint]\ndeps = \n    black\n    isort\n    flake8\ncommands =\n    black --check .\n    isort --check-only .\n    flake8 .\nEOF\n"})}),"\n",(0,l.jsx)(n.h3,{id:"step-2-install-tox",children:"Step 2: Install tox"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pip install tox\n"})}),"\n",(0,l.jsx)(n.h3,{id:"step-3-run-all-environments",children:"Step 3: Run all environments"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tox\n"})}),"\n",(0,l.jsx)(n.p,{children:"Output:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"py39 create: /project/.tox/py39\npy39 install: pytest, pytest-cov, requests\npy39 run-test-base: pytest tests/\n...\nPASSED: py39\nPASSED: py310\nPASSED: py311\nPASSED: py312\nPASSED: lint\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u2705 All environments pass = library works on Python 3.9\u20133.12."}),"\n",(0,l.jsx)(n.h3,{id:"step-4-use-in-cicd-github-actions",children:"Step 4: Use in CI/CD (GitHub Actions)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Tests\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        python-version: ['3.9', '3.10', '3.11', '3.12']\n    steps:\n      - uses: actions/checkout@v3\n      - uses: actions/setup-python@v4\n        with:\n          python-version: ${{ matrix.python-version }}\n      - run: pip install tox\n      - run: tox -e py${{ matrix.python-version }}\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-daily-workflow-to-remember",children:"\ud83e\udde0 Daily workflow to remember"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# First time setup\npip install tox\ncat > tox.ini << 'EOF'\n[tox]\nenvlist = py39,py310,py311,py312,lint\n\n[testenv]\ndeps = pytest\ncommands = pytest tests/\n\n[testenv:lint]\ndeps = black,flake8\ncommands = black .; flake8 .\nEOF\n\n# Daily: Run tests\ntox\n\n# Specific: Test Python 3.11\ntox -e py311\n\n# Specific: Lint only\ntox -e lint\n\n# Rebuild after dependency changes\ntox -r\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"-memory-trick",children:"\ud83e\udde0 Memory trick"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:'"Tox = multiple test environments at once"'})}),"\n",(0,l.jsxs)(n.p,{children:["Think: ",(0,l.jsx)(n.code,{children:"for py in [3.9, 3.10, 3.11, 3.12]: run_tests()"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>o});var t=s(6540);const l={},i=t.createContext(l);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);