"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[2433],{2505(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"security/api_keys","title":"API Keys","description":"Digital credentials to authenticate requests. Different from SSH keys.","source":"@site/../docs/security/api_keys.md","sourceDirName":"security","slug":"/security/api_keys","permalink":"/knowledge-base/docs/security/api_keys","draft":false,"unlisted":false,"editUrl":"https://github.com/thecodeshastra/knowledge-base/tree/main/site/../docs/security/api_keys.md","tags":[],"version":"current","frontMatter":{"title":"API Keys"},"sidebar":"docsSidebar","previous":{"title":"Troubleshooting & Debugging","permalink":"/knowledge-base/docs/programming/troubleshooting_debugging"},"next":{"title":"SSH","permalink":"/knowledge-base/docs/security/ssh"}}');var r=s(4848),t=s(8453);const l={title:"API Keys"},a="API Keys",d={},c=[{value:"What They Are",id:"what-they-are",level:2},{value:"How They Work",id:"how-they-work",level:2},{value:"Difference: API Keys vs SSH Keys",id:"difference-api-keys-vs-ssh-keys",level:2},{value:"Where to Get API Keys",id:"where-to-get-api-keys",level:2},{value:"GitHub",id:"github",level:3},{value:"Stripe",id:"stripe",level:3},{value:"OpenAI",id:"openai",level:3},{value:"Best Practices \ud83d\udea8",id:"best-practices-",level:2},{value:"Store API Keys Safely",id:"store-api-keys-safely",level:2},{value:"Environment Variables (.env file)",id:"environment-variables-env-file",level:3},{value:".gitignore",id:"gitignore",level:3},{value:"Rotate Keys",id:"rotate-keys",level:2},{value:"Handle API Key Errors",id:"handle-api-key-errors",level:2},{value:"API Key Scopes (Least Privilege)",id:"api-key-scopes-least-privilege",level:2},{value:"Detect Leaked Keys",id:"detect-leaked-keys",level:2},{value:"Rate Limiting with API Keys",id:"rate-limiting-with-api-keys",level:2},{value:"Multi-Environment Keys",id:"multi-environment-keys",level:2},{value:"Monitoring API Key Usage",id:"monitoring-api-key-usage",level:2},{value:"Common Mistakes",id:"common-mistakes",level:2},{value:"Quick Checklist",id:"quick-checklist",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"api-keys",children:"API Keys"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Digital credentials to authenticate requests. Different from SSH keys."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"what-they-are",children:"What They Are"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Digital tokens that prove who you are to a service"}),"\n",(0,r.jsx)(n.li,{children:"Every request to an API includes the key"}),"\n",(0,r.jsx)(n.li,{children:"Each key is unique to your account/project"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"how-they-work",children:"How They Work"}),"\n",(0,r.jsx)(n.p,{children:"Request to API:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -H "Authorization: Bearer YOUR_API_KEY" https://api.example.com/data\n'})}),"\n",(0,r.jsx)(n.p,{children:"Or in code:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import requests\n\nheaders = {"Authorization": f"Bearer {api_key}"}\nresponse = requests.get("https://api.example.com/data", headers=headers)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"difference-api-keys-vs-ssh-keys",children:"Difference: API Keys vs SSH Keys"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"SSH Key"}),(0,r.jsx)(n.th,{children:"API Key"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Purpose"})}),(0,r.jsx)(n.td,{children:"SSH connections, Git"}),(0,r.jsx)(n.td,{children:"HTTP API requests"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Transport"})}),(0,r.jsx)(n.td,{children:"TCP connection"}),(0,r.jsx)(n.td,{children:"HTTP header/query"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Typical use"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ssh user@host"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'curl -H "Auth: key"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Rotation"})}),(0,r.jsx)(n.td,{children:"Occasionally"}),(0,r.jsx)(n.td,{children:"Frequently"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Services"})}),(0,r.jsx)(n.td,{children:"GitHub, servers"}),(0,r.jsx)(n.td,{children:"Stripe, OpenAI, AWS"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"where-to-get-api-keys",children:"Where to Get API Keys"}),"\n",(0,r.jsx)(n.h3,{id:"github",children:"GitHub"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Personal access token\n# GitHub \u2192 Settings \u2192 Developer settings \u2192 Personal access tokens\n# Scopes: repo, read:user, delete:repo (be specific)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stripe",children:"Stripe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Dashboard \u2192 Developers \u2192 API keys\n# Publishable key (public) + Secret key (keep private)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"openai",children:"OpenAI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# https://platform.openai.com/account/api-keys\n# Create new secret key\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-",children:"Best Practices \ud83d\udea8"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"DO:"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Store in environment variables (",(0,r.jsx)(n.code,{children:".env"})," file)"]}),"\n",(0,r.jsx)(n.li,{children:"Rotate keys periodically (monthly/quarterly)"}),"\n",(0,r.jsx)(n.li,{children:"Use specific scopes (don't request all permissions)"}),"\n",(0,r.jsx)(n.li,{children:"Create keys per environment (dev/staging/prod)"}),"\n",(0,r.jsx)(n.li,{children:"Revoke unused keys immediately"}),"\n",(0,r.jsx)(n.li,{children:"Use short-lived tokens when possible"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u274c ",(0,r.jsx)(n.strong,{children:"DON'T:"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Commit keys to Git"}),"\n",(0,r.jsx)(n.li,{children:"Share keys via Slack/email"}),"\n",(0,r.jsx)(n.li,{children:"Use one key for all services"}),"\n",(0,r.jsx)(n.li,{children:"Store in plain text"}),"\n",(0,r.jsx)(n.li,{children:"Use keys with overly broad permissions"}),"\n",(0,r.jsx)(n.li,{children:"Keep old/unused keys active"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"store-api-keys-safely",children:"Store API Keys Safely"}),"\n",(0,r.jsx)(n.h3,{id:"environment-variables-env-file",children:"Environment Variables (.env file)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:".env"})," (don't commit):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"STRIPE_SECRET_KEY=sk_live_xxxxx\nOPENAI_API_KEY=sk-xxxxx\nGITHUB_TOKEN=ghp_xxxxx\n"})}),"\n",(0,r.jsx)(n.p,{children:"Python code:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\nstripe_key = os.getenv("STRIPE_SECRET_KEY")\nopenai_key = os.getenv("OPENAI_API_KEY")\n\n# Never:\n# stripe_key = "sk_live_xxxxx"  # \u274c DON\'T DO THIS\n'})}),"\n",(0,r.jsx)(n.h3,{id:"gitignore",children:".gitignore"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-gitignore",children:".env\n.env.local\n.env.*.local\nsecrets/\n*.key\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rotate-keys",children:"Rotate Keys"}),"\n",(0,r.jsx)(n.p,{children:"When to rotate:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Key exposed (leaked to Git, Slack, etc.)"}),"\n",(0,r.jsx)(n.li,{children:"Team member leaves"}),"\n",(0,r.jsx)(n.li,{children:"Regular schedule (quarterly)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"How to rotate:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create new key in dashboard"}),"\n",(0,r.jsx)(n.li,{children:"Update environment variable"}),"\n",(0,r.jsx)(n.li,{children:"Test that everything works"}),"\n",(0,r.jsx)(n.li,{children:"Revoke old key in dashboard"}),"\n",(0,r.jsx)(n.li,{children:"Wait a few hours, verify no failures"}),"\n",(0,r.jsx)(n.li,{children:"Delete old key permanently"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"handle-api-key-errors",children:"Handle API Key Errors"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import requests\n\ntry:\n    response = requests.get(\n        "https://api.example.com/data",\n        headers={"Authorization": f"Bearer {api_key}"}\n    )\nexcept requests.exceptions.HTTPError as e:\n    if e.response.status_code == 401:\n        print("Invalid API key")\n    elif e.response.status_code == 403:\n        print("Insufficient permissions")\n    elif e.response.status_code == 429:\n        print("Rate limited")\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"api-key-scopes-least-privilege",children:"API Key Scopes (Least Privilege)"}),"\n",(0,r.jsx)(n.p,{children:"Always request minimum permissions:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-markdown",children:'\u2705 Good:\n  - Stripe: "write:charges" only\n\n\u2705 Good:\n  - GitHub: "repo" (not "admin:repo_hook")\n\n\u2705 Good:\n  - AWS: Limited IAM policy with specific actions\n\n\u274c Bad:\n  - "admin" for everything\n  - "write:all" when you only need read\n  - "super_admin" if not necessary\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"detect-leaked-keys",children:"Detect Leaked Keys"}),"\n",(0,r.jsx)(n.p,{children:"Check if your key was exposed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# GitHub token leaked\ngit log -p --all | grep "ghp_"\n\n# Stripe key leaked\ngrep -r "sk_live_" .\n\n# General secrets scanner\npip install detect-secrets\ndetect-secrets scan --baseline .secrets.baseline\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"If key leaked:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Revoke immediately in dashboard"}),"\n",(0,r.jsx)(n.li,{children:"Search code history for usage"}),"\n",(0,r.jsx)(n.li,{children:"Check API logs for unauthorized access"}),"\n",(0,r.jsx)(n.li,{children:"Create new key"}),"\n",(0,r.jsx)(n.li,{children:"Rotate in environment"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rate-limiting-with-api-keys",children:"Rate Limiting with API Keys"}),"\n",(0,r.jsx)(n.p,{children:"Most APIs limit requests per key:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import time\nimport requests\nfrom functools import wraps\n\ndef rate_limit(calls_per_minute=60):\n    min_interval = 60 / calls_per_minute\n    \n    def decorator(func):\n        last_call = [0]\n        \n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            elapsed = time.time() - last_call[0]\n            wait = min_interval - elapsed\n            if wait > 0:\n                time.sleep(wait)\n            result = func(*args, **kwargs)\n            last_call[0] = time.time()\n            return result\n        return wrapper\n    return decorator\n\n@rate_limit(calls_per_minute=60)\ndef api_call(endpoint):\n    return requests.get(endpoint)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"multi-environment-keys",children:"Multi-Environment Keys"}),"\n",(0,r.jsx)(n.p,{children:"Setup:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"config/\n\u251c\u2500\u2500 .env.development    (local test keys)\n\u251c\u2500\u2500 .env.staging        (staging keys)\n\u251c\u2500\u2500 .env.production     (production keys - never commit)\n\u2514\u2500\u2500 .env.example        (template, commit this)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Load based on environment:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import os\nfrom dotenv import load_dotenv\n\nenv = os.getenv("ENVIRONMENT", "development")\nload_dotenv(f".env.{env}")\n\napi_key = os.getenv("API_KEY")\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"monitoring-api-key-usage",children:"Monitoring API Key Usage"}),"\n",(0,r.jsx)(n.p,{children:"Track usage in most services:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# GitHub\n# Settings \u2192 Developer settings \u2192 Personal access tokens \u2192 See tokens\n\n# Stripe\n# Dashboard \u2192 Developers \u2192 API activity\n\n# AWS\n# IAM \u2192 Users \u2192 [user] \u2192 Access Advisor\n\n# Google Cloud\n# APIs & Services \u2192 Credentials \u2192 See API usage\n"})}),"\n",(0,r.jsx)(n.p,{children:"Delete unused keys found."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,r.jsxs)(n.p,{children:["\u274c ",(0,r.jsx)(n.strong,{children:"Hardcoding keys:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# WRONG\nresponse = requests.get(url, headers={"key": "sk_live_xxxxx"})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Use environment:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# RIGHT\napi_key = os.getenv("STRIPE_KEY")\nresponse = requests.get(url, headers={"key": api_key})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u274c ",(0,r.jsx)(n.strong,{children:"One key for everything:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# WRONG - if this key leaks, everything is exposed\nUNIVERSAL_API_KEY=xxxx\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Separate keys:"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"STRIPE_KEY=xxxx\nOPENAI_KEY=yyyy\nGITHUB_TOKEN=zzzz\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"quick-checklist",children:"Quick Checklist"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 Keys in ",(0,r.jsx)(n.code,{children:".env"}),", not in code"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.code,{children:".env"})," in ",(0,r.jsx)(n.code,{children:".gitignore"})]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Different keys per environment"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Minimum required permissions"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Rotation schedule set"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Monitoring enabled"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Leaked keys revoked immediately"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);